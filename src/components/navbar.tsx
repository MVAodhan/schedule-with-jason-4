"use client";

import React, { useEffect, useState } from "react";
import { Menu, X } from "lucide-react";

import Link from "next/link";
import { Button } from "./ui/button";
import { useRouter } from "next/navigation";

import { useStore } from "@/lib/zustand-stores";

const Navbar = () => {
  const [isOpen, setIsOpen] = useState(false);
  const getUser = useStore((state) => state.getUser);
  const signOut = useStore((state) => state.signOut);

  const user = useStore((state) => state.user);

  const router = useRouter();

  const navigation = [{ name: "Home", href: "/" }];
  const userNavigation = [{ name: "New", href: "/new" }];

  useEffect(() => {
    getUser();
  }, []);

  return (
    <nav className="bg-white shadow-lg">
      <div className="max-w-7xl mx-auto px-4">
        <div className="flex justify-between h-16">
          {/* Logo */}
          <div className="flex items-center">
            <Link href="/" className="text-gray-800">
              <svg
                width="100"
                height="50"
                viewBox="0 0 199 50"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.8 40.72C8.12 40.72 6.64 40.4267 5.36 39.84C4.08 39.2533 3.09333 38.44 2.4 37.4C1.70667 36.3333 1.36 35.1067 1.36 33.72C1.36 32.5467 1.6 31.48 2.08 30.52C2.58667 29.56 3.25333 28.8 4.08 28.24C4.93333 27.68 5.86667 27.4 6.88 27.4C7.81333 27.4 8.6 27.64 9.24 28.12C9.88 28.5733 10.28 29.2133 10.44 30.04C9.05333 30.04 7.94667 30.4133 7.12 31.16C6.29333 31.88 5.88 32.8667 5.88 34.12C5.88 35.2667 6.22667 36.1867 6.92 36.88C7.61333 37.5733 8.53333 37.92 9.68 37.92C11.0933 37.92 12.2533 37.4533 13.16 36.52C14.0933 35.56 14.56 34.36 14.56 32.92C14.56 31.6667 14.2133 30.48 13.52 29.36C12.8267 28.24 11.7867 26.88 10.4 25.28C8.96 23.6267 7.86667 22.2133 7.12 21.04C6.4 19.84 6.04 18.5333 6.04 17.12C6.04 15.7333 6.42667 14.4933 7.2 13.4C7.97333 12.28 9.04 11.4 10.4 10.76C11.76 10.12 13.2933 9.8 15 9.8C17.16 9.8 18.88 10.3067 20.16 11.32C21.4667 12.3333 22.12 13.6933 22.12 15.4C22.12 16.52 21.84 17.4267 21.28 18.12C20.72 18.8133 19.9867 19.16 19.08 19.16C18.0667 19.16 17.2533 18.7467 16.64 17.92C17.1467 17.5467 17.5467 17.0533 17.84 16.44C18.1333 15.8267 18.28 15.1867 18.28 14.52C18.28 13.6667 18.0267 12.9867 17.52 12.48C17.0133 11.9733 16.32 11.72 15.44 11.72C14.3733 11.72 13.4933 12.1067 12.8 12.88C12.1333 13.6267 11.8 14.5867 11.8 15.76C11.8 16.8267 12.1067 17.8267 12.72 18.76C13.3333 19.6667 14.2933 20.84 15.6 22.28C16.6667 23.4267 17.52 24.4133 18.16 25.24C18.8267 26.0667 19.3867 27.0267 19.84 28.12C20.32 29.1867 20.56 30.3467 20.56 31.6C20.56 33.3067 20.08 34.8533 19.12 36.24C18.1867 37.6267 16.8933 38.72 15.24 39.52C13.6133 40.32 11.8 40.72 9.8 40.72ZM28.5325 40.24C26.5592 40.24 25.0258 39.7333 23.9325 38.72C22.8392 37.68 22.2925 36.0667 22.2925 33.88C22.2925 32.04 22.6525 30.0133 23.3725 27.8C24.1192 25.5867 25.2925 23.68 26.8925 22.08C28.5192 20.4533 30.5725 19.64 33.0525 19.64C34.6525 19.64 35.7858 19.9867 36.4525 20.68C37.1458 21.3733 37.4925 22.2533 37.4925 23.32C37.4925 24.2533 37.2925 24.9733 36.8925 25.48C36.4925 25.9867 35.9858 26.24 35.3725 26.24C34.9192 26.24 34.4525 26.08 33.9725 25.76C34.2925 24.88 34.4525 24.0933 34.4525 23.4C34.4525 22.8933 34.3592 22.4933 34.1725 22.2C33.9858 21.9067 33.7058 21.76 33.3325 21.76C32.5325 21.76 31.7325 22.4133 30.9325 23.72C30.1325 25.0267 29.4792 26.6133 28.9725 28.48C28.4658 30.3467 28.2125 32.0267 28.2125 33.52C28.2125 34.8267 28.4392 35.72 28.8925 36.2C29.3458 36.6533 30.0792 36.88 31.0925 36.88C32.5325 36.88 33.7592 36.5467 34.7725 35.88C35.8125 35.2133 36.9458 34.2 38.1725 32.84H39.5325C36.5725 37.7733 32.9058 40.24 28.5325 40.24ZM52.6041 40.24C50.9774 40.24 49.7774 39.8133 49.0041 38.96C48.2574 38.08 47.8841 37 47.8841 35.72C47.8841 35.16 47.9507 34.5333 48.0841 33.84C48.2174 33.12 48.3507 32.4267 48.4841 31.76C48.6441 31.0933 48.7507 30.6667 48.8041 30.48C49.0174 29.5467 49.2174 28.6267 49.4041 27.72C49.5907 26.8133 49.6841 26.08 49.6841 25.52C49.6841 24.16 49.2041 23.48 48.2441 23.48C47.5507 23.48 46.9374 23.8267 46.4041 24.52C45.8707 25.1867 45.4441 26.0667 45.1241 27.16L42.4041 40H36.6441L42.4441 12.8L48.3641 12L46.2041 22.08C47.5374 20.5867 49.0974 19.84 50.8841 19.84C52.2441 19.84 53.3241 20.2133 54.1241 20.96C54.9241 21.7067 55.3241 22.84 55.3241 24.36C55.3241 25.1333 55.2307 26 55.0441 26.96C54.8574 27.8933 54.5907 29.04 54.2441 30.4C54.0307 31.2267 53.8307 32.04 53.6441 32.84C53.4841 33.6133 53.4041 34.2267 53.4041 34.68C53.4041 35.2133 53.5241 35.6267 53.7641 35.92C54.0041 36.2133 54.4174 36.36 55.0041 36.36C55.8041 36.36 56.4441 36.08 56.9241 35.52C57.4041 34.9333 57.8841 34.04 58.3641 32.84H60.0441C59.0574 35.7733 57.9107 37.7467 56.6041 38.76C55.3241 39.7467 53.9907 40.24 52.6041 40.24ZM64.0794 40.24C62.106 40.24 60.5727 39.7333 59.4794 38.72C58.386 37.68 57.8394 36.0667 57.8394 33.88C57.8394 32.04 58.1994 30.0133 58.9194 27.8C59.6394 25.5867 60.8127 23.68 62.4394 22.08C64.066 20.4533 66.1327 19.64 68.6394 19.64C71.5727 19.64 73.0394 20.92 73.0394 23.48C73.0394 24.9733 72.6127 26.3467 71.7594 27.6C70.906 28.8533 69.7727 29.8667 68.3594 30.64C66.946 31.3867 65.4394 31.8133 63.8394 31.92C63.786 32.72 63.7594 33.2533 63.7594 33.52C63.7594 34.8267 63.986 35.72 64.4394 36.2C64.8927 36.6533 65.626 36.88 66.6394 36.88C68.0794 36.88 69.306 36.5467 70.3194 35.88C71.3594 35.2133 72.4927 34.2 73.7194 32.84H75.0794C72.1194 37.7733 68.4527 40.24 64.0794 40.24ZM64.1594 30C65.146 29.9467 66.0794 29.6 66.9594 28.96C67.866 28.32 68.586 27.5067 69.1194 26.52C69.6794 25.5333 69.9594 24.4933 69.9594 23.4C69.9594 22.3067 69.626 21.76 68.9594 21.76C67.9994 21.76 67.0527 22.6 66.1194 24.28C65.2127 25.96 64.5594 27.8667 64.1594 30ZM78.5109 40.24C76.9909 40.24 75.7243 39.72 74.7109 38.68C73.6976 37.64 73.1909 36.0133 73.1909 33.8C73.1909 31.8267 73.5776 29.76 74.3509 27.6C75.1509 25.4133 76.3243 23.5733 77.8709 22.08C79.4443 20.56 81.3109 19.8 83.4709 19.8C84.5643 19.8 85.3776 19.9867 85.9109 20.36C86.4443 20.7333 86.7109 21.2267 86.7109 21.84V22L88.6709 12.8L94.5909 12L89.9909 33.6C89.8843 34 89.8309 34.4267 89.8309 34.88C89.8309 35.4133 89.9509 35.8 90.1909 36.04C90.4576 36.2533 90.8843 36.36 91.4709 36.36C92.2176 36.36 92.8576 36.04 93.3909 35.4C93.9509 34.76 94.3909 33.9067 94.7109 32.84H96.3909C94.7643 37.6133 92.0843 40 88.3509 40C87.2576 40 86.3643 39.7067 85.6709 39.12C85.0043 38.5333 84.5909 37.68 84.4309 36.56C83.7376 37.6267 82.8976 38.5067 81.9109 39.2C80.9509 39.8933 79.8176 40.24 78.5109 40.24ZM81.1109 36.36C81.7509 36.36 82.3909 36.0667 83.0309 35.48C83.6976 34.8933 84.1509 34.08 84.3909 33.04V32.84L86.3509 23.68C86.1109 22.7467 85.5643 22.28 84.7109 22.28C83.6443 22.28 82.6843 22.9067 81.8309 24.16C80.9776 25.3867 80.3109 26.88 79.8309 28.64C79.3509 30.3733 79.1109 31.9067 79.1109 33.24C79.1109 34.5733 79.2976 35.4267 79.6709 35.8C80.0709 36.1733 80.5509 36.36 81.1109 36.36ZM98.6866 40.24C97.4066 40.24 96.3666 39.84 95.5666 39.04C94.7932 38.24 94.4066 37.04 94.4066 35.44C94.4066 34.7733 94.5132 33.9067 94.7266 32.84L97.4466 20H103.207L100.327 33.6C100.247 34 100.207 34.3733 100.207 34.72C100.207 35.8133 100.607 36.36 101.407 36.36C102.153 36.36 102.793 36.0533 103.327 35.44C103.86 34.8 104.287 33.9333 104.607 32.84L107.327 20H113.087L110.207 33.6C110.1 34 110.047 34.4267 110.047 34.88C110.047 35.4133 110.167 35.8 110.407 36.04C110.673 36.2533 111.1 36.36 111.687 36.36C112.433 36.36 113.073 36.04 113.607 35.4C114.167 34.76 114.607 33.9067 114.927 32.84H116.607C115.62 35.72 114.393 37.68 112.927 38.72C111.487 39.7333 110.033 40.24 108.567 40.24C107.42 40.24 106.5 39.92 105.807 39.28C105.14 38.64 104.74 37.6933 104.607 36.44C103.7 37.9067 102.74 38.9067 101.727 39.44C100.74 39.9733 99.7266 40.24 98.6866 40.24ZM118.882 40.24C117.602 40.24 116.562 39.84 115.762 39.04C114.989 38.24 114.602 37.04 114.602 35.44C114.602 34.7733 114.709 33.9067 114.922 32.84L119.202 12.8L125.122 12L120.522 33.6C120.415 34 120.362 34.4267 120.362 34.88C120.362 35.4133 120.482 35.8 120.722 36.04C120.989 36.2533 121.415 36.36 122.002 36.36C122.775 36.36 123.495 36.04 124.162 35.4C124.829 34.7333 125.309 33.88 125.602 32.84H127.282C126.295 35.72 125.029 37.68 123.482 38.72C121.935 39.7333 120.402 40.24 118.882 40.24ZM131.226 40.24C129.279 40.24 127.759 39.7333 126.666 38.72C125.573 37.68 125.026 36.0667 125.026 33.88C125.026 32.04 125.386 30.0133 126.106 27.8C126.826 25.5867 127.999 23.68 129.626 22.08C131.253 20.4533 133.319 19.64 135.826 19.64C138.759 19.64 140.226 20.92 140.226 23.48C140.226 24.9733 139.799 26.3467 138.946 27.6C138.093 28.8533 136.959 29.8667 135.546 30.64C134.133 31.3867 132.626 31.8133 131.026 31.92C130.973 32.5067 130.946 32.9067 130.946 33.12C130.946 35.3333 131.773 36.44 133.426 36.44C134.173 36.44 134.973 36.24 135.826 35.84C136.679 35.44 137.453 34.9333 138.146 34.32C137.426 38.2667 135.119 40.24 131.226 40.24ZM131.306 30C132.319 29.9733 133.266 29.64 134.146 29C135.053 28.36 135.773 27.5467 136.306 26.56C136.866 25.5467 137.146 24.4933 137.146 23.4C137.146 22.3067 136.813 21.76 136.146 21.76C135.213 21.76 134.279 22.6133 133.346 24.32C132.439 26 131.759 27.8933 131.306 30Z"
                  fill="black"
                />
                <path
                  d="M163.564 37.216C162.412 37.216 161.476 36.856 160.756 36.136C160.06 35.416 159.712 34.336 159.712 32.896C159.712 32.296 159.808 31.516 160 30.556L162.16 20.44H160.972L161.26 19H162.448L163.528 14.032L168.856 13.312L167.632 19H169.792L169.504 20.44H167.344L165.04 31.24C164.944 31.6 164.896 31.984 164.896 32.392C164.896 32.872 165.004 33.22 165.22 33.436C165.46 33.628 165.844 33.724 166.372 33.724C167.068 33.724 167.716 33.436 168.316 32.86C168.916 32.26 169.348 31.492 169.612 30.556H171.124C170.236 33.148 169.096 34.912 167.704 35.848C166.312 36.76 164.932 37.216 163.564 37.216ZM173.702 37.216C172.31 37.216 171.218 36.868 170.426 36.172C169.658 35.452 169.274 34.384 169.274 32.968C169.274 32.392 169.334 31.816 169.454 31.24L172.046 19H177.23L174.638 31.24C174.518 31.84 174.458 32.272 174.458 32.536C174.458 33.328 174.866 33.724 175.682 33.724C176.786 33.724 177.806 33.028 178.742 31.636C179.702 30.244 180.47 28.588 181.046 26.668C181.622 24.748 181.91 23.092 181.91 21.7C181.862 21.82 181.706 21.916 181.442 21.988C181.178 22.036 180.95 22.06 180.758 22.06C180.35 22.06 180.026 21.868 179.786 21.484C179.57 21.1 179.462 20.68 179.462 20.224C179.462 19.648 179.642 19.18 180.002 18.82C180.386 18.46 180.95 18.28 181.694 18.28C182.486 18.28 183.062 18.58 183.422 19.18C183.782 19.756 183.962 20.5 183.962 21.412C183.962 23.572 183.59 25.888 182.846 28.36C182.102 30.808 180.962 32.896 179.426 34.624C177.89 36.352 175.982 37.216 173.702 37.216Z"
                  fill="black"
                />
                <path
                  d="M147 28.5001C147 15.5002 145.938 8.28399 153.5 8.00019C159.32 7.78176 183.5 7.5 195 8.00021C198 8.00021 197.5 13.1971 197.5 15.5002C197.5 25.5004 197.5 32.0001 197.5 32.0001C197.5 46.0001 186.5 42.0001 170 43.0001C148 43.0001 147.5 41.0001 147 28.5001Z"
                  stroke="black"
                />
              </svg>
            </Link>
          </div>

          {/* Desktop Navigation */}
          <div className="hidden md:flex items-center space-x-4">
            {navigation.map((item) => (
              <div key={item.name} className="relative">
                <Link
                  href={item.href}
                  className="px-3 py-2 text-gray-700 hover:text-gray-900"
                >
                  {item.name}
                </Link>
              </div>
            ))}

            <div>
              {userNavigation &&
                userNavigation.map((item) => (
                  <Link
                    key={item.name}
                    href={item.href}
                    className="px-3 py-2 text-gray-700 hover:text-gray-900"
                  >
                    {item.name}
                  </Link>
                ))}
            </div>
            {user ? (
              <Button
                onClick={() => {
                  signOut();
                  router.push("/");
                }}
              >
                Sign out
              </Button>
            ) : (
              <Link href={"/login"}>
                <Button>Login</Button>
              </Link>
            )}
          </div>

          {/* Mobile menu button */}
          <div className="md:hidden flex items-center">
            <button
              onClick={() => setIsOpen(!isOpen)}
              className="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100 focus:outline-none"
            >
              {isOpen ? (
                <X className="h-6 w-6" />
              ) : (
                <Menu className="h-6 w-6" />
              )}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile menu */}
      <div className={`md:hidden ${isOpen ? "block" : "hidden"}`}>
        <div className="px-2 pt-2 pb-3 space-y-1">
          {navigation.map((item) => (
            <div key={item.name}>
              <Link
                href={item.href}
                className="block px-3 py-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100"
              >
                {item.name}
              </Link>
            </div>
          ))}
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
